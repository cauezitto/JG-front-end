{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport Paragraph from 'components/Paragraph';\nimport * as S from './styles';\nimport { MdKeyboardArrowLeft } from 'react-icons/md';\nimport { CgCloseO } from 'react-icons/cg';\nimport Heading from 'components/Heading';\nimport { FiMinusCircle, FiPlusCircle } from 'react-icons/fi';\nimport { useState, useEffect } from 'react';\nimport Input from 'components/Input';\nimport Button from 'components/Button';\nimport Link from 'next/link';\nimport { useStateContext } from 'context';\nimport handlePrice from 'utils/handlePrice';\nimport PriceHandler from 'utils/handlePrice';\nimport api from 'services/api';\n\nvar MiniCart = function MiniCart(_ref) {\n  var onClose = _ref.onClose;\n\n  var _useStateContext = useStateContext(),\n      cart = _useStateContext.cart,\n      setCart = _useStateContext.setCart,\n      server = _useStateContext.server;\n\n  var _useState = useState(''),\n      cupom = _useState[0],\n      setCupom = _useState[1];\n\n  var _useState2 = useState(0),\n      cashBackPercent = _useState2[0],\n      setCashBackPercent = _useState2[1];\n\n  var _useState3 = useState(0),\n      cashBack = _useState3[0],\n      setCashBack = _useState3[1];\n\n  var handleDelete = function handleDelete(position) {\n    var total = 0.0;\n    var products = cart.products.filter(function (product) {\n      return product !== cart.products[position];\n    });\n    console.log(products);\n    products.map(function (product) {\n      total = total + product.preco * product.quant;\n    });\n    setCart({\n      products: products,\n      total: total\n    });\n  };\n\n  var cupomCheck = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return api.get(\"/cupom/\".concat(cupom)).then(function (response) {\n                var desconto = response.data.desconto;\n                setCashBackPercent(desconto);\n              })[\"catch\"](function (err) {\n                console.log(err);\n                alert('Cumpom inv√°lido');\n              });\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function cupomCheck() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var cashBackCalculate = function cashBackCalculate() {\n    var total = cart.total;\n    var discount = total / 100 * cashBackPercent; // discount = total * cashBackPercent\n\n    setCashBack(discount);\n  };\n\n  useEffect(function () {\n    cashBackCalculate();\n  }, [cart, cashBackPercent]);\n\n  var handleAdd = function handleAdd(position) {\n    var products = cart.products;\n    var total = 0;\n    products[position].quant = products[position].quant + 1;\n    products.map(function (product) {\n      total = total + product.preco * product.quant;\n    });\n    setCart({\n      products: products,\n      total: total\n    });\n  };\n\n  var handleSub = function handleSub(position) {\n    var products = cart.products;\n    var total = 0;\n\n    if (products[position].quant === 1) {\n      return;\n    }\n\n    products[position].quant = products[position].quant - 1;\n    products.map(function (product) {\n      total = total + product.preco * product.quant;\n    });\n    setCart({\n      products: products,\n      total: total\n    });\n  };\n\n  useEffect(function () {\n    if (cart.total === 0) {\n      onClose();\n    }\n  }, [cart]);\n  return /*#__PURE__*/_jsxs(S.Wrapper, {\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: \"close\",\n      children: /*#__PURE__*/_jsx(MdKeyboardArrowLeft, {\n        onClick: onClose\n      })\n    }), /*#__PURE__*/_jsx(Paragraph, {\n      color: \"black\",\n      fontSize: \"small\",\n      font: \"ubuntu\",\n      fontWeight: \"semiBold\",\n      justify: \"center\",\n      textAlign: \"center\",\n      children: \"ITENS ADICIONADOS NO CARRINHO DE COMPRAS\"\n    }), /*#__PURE__*/_jsxs(S.Header, {\n      children: [/*#__PURE__*/_jsx(Paragraph, {\n        color: \"gray300\",\n        fontSize: \"medium\",\n        font: \"ubuntu\",\n        justify: \"center\",\n        textAlign: \"center\",\n        children: \"Produto\"\n      }), /*#__PURE__*/_jsx(Paragraph, {\n        color: \"gray300\",\n        fontSize: \"medium\",\n        font: \"ubuntu\",\n        justify: \"center\",\n        textAlign: \"center\",\n        children: \"Pre\\xE7o Un\\xEDtario\"\n      }), /*#__PURE__*/_jsx(Paragraph, {\n        color: \"gray300\",\n        fontSize: \"medium\",\n        font: \"ubuntu\",\n        justify: \"center\",\n        textAlign: \"center\",\n        children: \"Quantidade\"\n      }), /*#__PURE__*/_jsx(\"div\", {})]\n    }), /*#__PURE__*/_jsx(S.ProductsList, {\n      children: cart.products.map(function (product, index) {\n        return /*#__PURE__*/_jsxs(_Fragment, {\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: \"product cell\",\n            children: [/*#__PURE__*/_jsx(\"img\", {\n              src: server + product.cover.url,\n              alt: product.nome,\n              className: \"product-image\"\n            }), /*#__PURE__*/_jsx(Paragraph, {\n              color: \"black\",\n              fontWeight: \"bold\",\n              fontSize: \"large\",\n              justify: \"center\",\n              textAlign: \"center\",\n              children: product.nome\n            }), /*#__PURE__*/_jsxs(Paragraph, {\n              color: \"black\",\n              font: \"ubuntu\",\n              fontSize: \"xsmall\",\n              justify: \"center\",\n              textAlign: \"center\",\n              children: [/*#__PURE__*/_jsx(\"strong\", {\n                children: \"Refer\\xEAncia:\"\n              }), \" \", product.slug]\n            })]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"price cell\",\n            children: /*#__PURE__*/_jsx(Heading, {\n              fontSize: \"xlarge\",\n              role: \"h4\",\n              lineBottom: false,\n              margin: \"0\",\n              justify: \"center\",\n              children: handlePrice.priceNumberToReadblePrice(product.preco)\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"quant cell\",\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              className: \"quant-controller\",\n              children: [/*#__PURE__*/_jsx(FiMinusCircle, {\n                onClick: function onClick() {\n                  handleSub(index);\n                }\n              }), product.quant, /*#__PURE__*/_jsx(FiPlusCircle, {\n                onClick: function onClick() {\n                  handleAdd(index);\n                }\n              })]\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"erase cell\",\n            children: /*#__PURE__*/_jsx(CgCloseO, {\n              onClick: function onClick() {\n                handleDelete(index);\n              }\n            })\n          })]\n        });\n      })\n    }), /*#__PURE__*/_jsxs(S.VoucherContainer, {\n      children: [/*#__PURE__*/_jsx(Paragraph, {\n        color: \"black\",\n        fontSize: \"large\",\n        fontWeight: \"semiBold\",\n        children: \"CUPOM DE DESCONTO\"\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"input-container\",\n        children: [/*#__PURE__*/_jsx(Input, {\n          value: cupom,\n          onChange: function onChange(e) {\n            return setCupom(e.target.value.toUpperCase());\n          }\n        }), \"\\xA0\", /*#__PURE__*/_jsx(Button, {\n          fill: \"brown\",\n          onClick: cupomCheck,\n          children: \"OK\"\n        })]\n      })]\n    }), /*#__PURE__*/_jsx(S.SubTotal, {\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        children: [\"Subtotal:\", ' ', /*#__PURE__*/_jsx(\"strong\", {\n          children: PriceHandler.priceNumberToReadblePrice(cart.total - cashBack)\n        })]\n      })\n    }), /*#__PURE__*/_jsxs(S.BuyOrView, {\n      children: [/*#__PURE__*/_jsx(\"div\", {}), /*#__PURE__*/_jsx(Link, {\n        href: \"/carrinho\",\n        passHref: true,\n        children: /*#__PURE__*/_jsx(\"a\", {\n          children: /*#__PURE__*/_jsx(Button, {\n            fill: \"red100\",\n            fontSize: \"large\",\n            children: \"FINALIZAR COMPRA\"\n          })\n        })\n      })]\n    })]\n  });\n};\n\nexport default MiniCart;","map":null,"metadata":{},"sourceType":"module"}