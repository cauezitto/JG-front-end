{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\cauezitto\\\\Documents\\\\projetos\\\\JG\\\\front-end\\\\src\\\\components\\\\MiniCart\\\\index.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport Paragraph from 'components/Paragraph';\nimport * as S from './styles';\nimport { MdKeyboardArrowLeft } from 'react-icons/md';\nimport { CgCloseO } from 'react-icons/cg';\nimport Heading from 'components/Heading';\nimport { FiMinusCircle, FiPlusCircle } from 'react-icons/fi';\nimport { useState, useEffect } from 'react';\nimport Input from 'components/Input';\nimport Button from 'components/Button';\nimport Link from 'next/link';\nimport { useStateContext } from 'context';\nimport handlePrice from 'utils/handlePrice';\nimport PriceHandler from 'utils/handlePrice';\nimport api from 'services/api';\n\nvar MiniCart = function MiniCart(_ref) {\n  _s();\n\n  var onClose = _ref.onClose;\n\n  var _useStateContext = useStateContext(),\n      cart = _useStateContext.cart,\n      setCart = _useStateContext.setCart,\n      server = _useStateContext.server;\n\n  var _useState = useState(''),\n      cupom = _useState[0],\n      setCupom = _useState[1];\n\n  var _useState2 = useState(0),\n      cashBackPercent = _useState2[0],\n      setCashBackPercent = _useState2[1];\n\n  var _useState3 = useState(0),\n      cashBack = _useState3[0],\n      setCashBack = _useState3[1];\n\n  var handleDelete = function handleDelete(position) {\n    var total = 0.0;\n    var products = cart.products.filter(function (product) {\n      return product !== cart.products[position];\n    });\n    console.log(products);\n    products.map(function (product) {\n      total = total + product.preco * product.quant;\n    });\n    setCart({\n      products: products,\n      total: total\n    });\n  };\n\n  var cupomCheck = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return api.get(\"/cupom/\".concat(cupom)).then(function (response) {\n                var desconto = response.data.desconto;\n                setCashBackPercent(desconto);\n              })[\"catch\"](function (err) {\n                console.log(err);\n                alert('Cumpom inválido');\n              });\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function cupomCheck() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var cashBackCalculate = function cashBackCalculate() {\n    var total = cart.total;\n    var discount = total / 100 * cashBackPercent; // discount = total * cashBackPercent\n\n    setCashBack(discount);\n  };\n\n  useEffect(function () {\n    cashBackCalculate();\n  }, [cart, cashBackPercent]);\n\n  var handleAdd = function handleAdd(position) {\n    var products = cart.products;\n    var total = 0;\n    products[position].quant = products[position].quant + 1;\n    products.map(function (product) {\n      total = total + product.preco * product.quant;\n    });\n    setCart({\n      products: products,\n      total: total\n    });\n  };\n\n  var handleSub = function handleSub(position) {\n    var products = cart.products;\n    var total = 0;\n\n    if (products[position].quant === 1) {\n      return;\n    }\n\n    products[position].quant = products[position].quant - 1;\n    products.map(function (product) {\n      total = total + product.preco * product.quant;\n    });\n    setCart({\n      products: products,\n      total: total\n    });\n  };\n\n  useEffect(function () {\n    if (cart.total === 0) {\n      onClose();\n    }\n  }, [cart]);\n  return /*#__PURE__*/_jsxDEV(S.Wrapper, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"close\",\n      children: /*#__PURE__*/_jsxDEV(MdKeyboardArrowLeft, {\n        onClick: onClose\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Paragraph, {\n      color: \"black\",\n      fontSize: \"small\",\n      font: \"ubuntu\",\n      fontWeight: \"semiBold\",\n      justify: \"center\",\n      textAlign: \"center\",\n      children: \"ITENS ADICIONADOS NO CARRINHO DE COMPRAS\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(S.Header, {\n      children: [/*#__PURE__*/_jsxDEV(Paragraph, {\n        color: \"gray300\",\n        fontSize: \"medium\",\n        font: \"ubuntu\",\n        justify: \"center\",\n        textAlign: \"center\",\n        children: \"Produto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(Paragraph, {\n        color: \"gray300\",\n        fontSize: \"medium\",\n        font: \"ubuntu\",\n        justify: \"center\",\n        textAlign: \"center\",\n        children: \"Pre\\xE7o Un\\xEDtario\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(Paragraph, {\n        color: \"gray300\",\n        fontSize: \"medium\",\n        font: \"ubuntu\",\n        justify: \"center\",\n        textAlign: \"center\",\n        children: \"Quantidade\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(S.ProductsList, {\n      children: cart.products.map(function (product, index) {\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"product cell\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: server + product.cover.url,\n              alt: product.nome,\n              className: \"product-image\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 15\n            }, _this), /*#__PURE__*/_jsxDEV(Paragraph, {\n              color: \"black\",\n              fontWeight: \"bold\",\n              fontSize: \"large\",\n              justify: \"center\",\n              textAlign: \"center\",\n              children: product.nome\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 15\n            }, _this), /*#__PURE__*/_jsxDEV(Paragraph, {\n              color: \"black\",\n              font: \"ubuntu\",\n              fontSize: \"xsmall\",\n              justify: \"center\",\n              textAlign: \"center\",\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Refer\\xEAncia:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 188,\n                columnNumber: 17\n              }, _this), \" \", product.slug]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 15\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"price cell\",\n            children: /*#__PURE__*/_jsxDEV(Heading, {\n              fontSize: \"xlarge\",\n              role: \"h4\",\n              lineBottom: false,\n              margin: \"0\",\n              justify: \"center\",\n              children: handlePrice.priceNumberToReadblePrice(product.preco)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"quant cell\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"quant-controller\",\n              children: [/*#__PURE__*/_jsxDEV(FiMinusCircle, {\n                onClick: function onClick() {\n                  handleSub(index);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 17\n              }, _this), product.quant, /*#__PURE__*/_jsxDEV(FiPlusCircle, {\n                onClick: function onClick() {\n                  handleAdd(index);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 212,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"erase cell\",\n            children: /*#__PURE__*/_jsxDEV(CgCloseO, {\n              onClick: function onClick() {\n                handleDelete(index);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(S.VoucherContainer, {\n      children: [/*#__PURE__*/_jsxDEV(Paragraph, {\n        color: \"black\",\n        fontSize: \"large\",\n        fontWeight: \"semiBold\",\n        children: \"CUPOM DE DESCONTO\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"input-container\",\n        children: [/*#__PURE__*/_jsxDEV(Input, {\n          value: cupom,\n          onChange: function onChange(e) {\n            return setCupom(e.target.value.toUpperCase());\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 11\n        }, _this), \"\\xA0\", /*#__PURE__*/_jsxDEV(Button, {\n          fill: \"brown\",\n          onClick: cupomCheck,\n          children: \"OK\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(S.SubTotal, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Subtotal:\", ' ', /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: PriceHandler.priceNumberToReadblePrice(cart.total - cashBack)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(S.BuyOrView, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(Link, {\n        href: \"/carrinho\",\n        passHref: true,\n        children: /*#__PURE__*/_jsxDEV(\"a\", {\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            fill: \"red100\",\n            fontSize: \"large\",\n            children: \"FINALIZAR COMPRA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 113,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(MiniCart, \"IsmU0TLsaPErUxNJZJKfu0N9vDk=\", false, function () {\n  return [useStateContext];\n});\n\n_c = MiniCart;\nexport default MiniCart;\n\nvar _c;\n\n$RefreshReg$(_c, \"MiniCart\");","map":{"version":3,"sources":["C:/Users/cauezitto/Documents/projetos/JG/front-end/src/components/MiniCart/index.tsx"],"names":["Paragraph","S","MdKeyboardArrowLeft","CgCloseO","Heading","FiMinusCircle","FiPlusCircle","useState","useEffect","Input","Button","Link","useStateContext","handlePrice","PriceHandler","api","MiniCart","onClose","cart","setCart","server","cupom","setCupom","cashBackPercent","setCashBackPercent","cashBack","setCashBack","handleDelete","position","total","products","filter","product","console","log","map","preco","quant","cupomCheck","get","then","response","desconto","data","err","alert","cashBackCalculate","discount","handleAdd","handleSub","index","cover","url","nome","slug","priceNumberToReadblePrice","e","target","value","toUpperCase"],"mappings":"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","sourcesContent":["import Paragraph from 'components/Paragraph'\nimport * as S from './styles'\nimport { MdKeyboardArrowLeft } from 'react-icons/md'\nimport { CgCloseO } from 'react-icons/cg'\nimport Heading from 'components/Heading'\nimport { FiMinusCircle, FiPlusCircle } from 'react-icons/fi'\nimport { useState, useEffect } from 'react'\nimport Input from 'components/Input'\nimport Button from 'components/Button'\nimport Link from 'next/link'\nimport { useStateContext } from 'context'\nimport handlePrice from 'utils/handlePrice'\nimport PriceHandler from 'utils/handlePrice'\nimport api from 'services/api'\n\nexport type Props = {\n  onClose: VoidFunction\n}\n\nconst MiniCart = ({ onClose }: Props) => {\n  const { cart, setCart, server } = useStateContext()\n  const [cupom, setCupom] = useState('')\n  const [cashBackPercent, setCashBackPercent] = useState(0)\n  const [cashBack, setCashBack] = useState(0)\n\n  const handleDelete = (position: number) => {\n    let total = 0.0\n\n    const products = cart.products.filter(\n      (product) => product !== cart.products[position]\n    )\n    console.log(products)\n\n    products.map((product) => {\n      total = total + product.preco * product.quant\n    })\n\n    setCart({\n      products,\n      total\n    })\n  }\n  const cupomCheck = async () => {\n    await api\n      .get(`/cupom/${cupom}`)\n      .then((response) => {\n        const { desconto } = response.data\n        setCashBackPercent(desconto)\n      })\n      .catch((err) => {\n        console.log(err)\n        alert('Cumpom inválido')\n      })\n  }\n\n  const cashBackCalculate = () => {\n    const total = cart.total\n\n    const discount = (total / 100) * cashBackPercent\n    // discount = total * cashBackPercent\n\n    setCashBack(discount)\n  }\n\n  useEffect(() => {\n    cashBackCalculate()\n  }, [cart, cashBackPercent])\n\n  const handleAdd = (position: number) => {\n    const products = cart.products\n    let total = 0\n\n    products[position].quant = products[position].quant + 1\n\n    products.map((product) => {\n      total = total + product.preco * product.quant\n    })\n\n    setCart({\n      products,\n      total\n    })\n  }\n\n  const handleSub = (position: number) => {\n    const products = cart.products\n\n    let total = 0\n\n    if (products[position].quant === 1) {\n      return\n    }\n\n    products[position].quant = products[position].quant - 1\n\n    products.map((product) => {\n      total = total + product.preco * product.quant\n    })\n\n    setCart({\n      products,\n      total\n    })\n  }\n\n  useEffect(() => {\n    if (cart.total === 0) {\n      onClose()\n    }\n  }, [cart])\n\n  return (\n    <S.Wrapper>\n      <div className=\"close\">\n        <MdKeyboardArrowLeft onClick={onClose} />\n      </div>\n      <Paragraph\n        color=\"black\"\n        fontSize=\"small\"\n        font=\"ubuntu\"\n        fontWeight=\"semiBold\"\n        justify=\"center\"\n        textAlign=\"center\"\n      >\n        ITENS ADICIONADOS NO CARRINHO DE COMPRAS\n      </Paragraph>\n\n      <S.Header>\n        <Paragraph\n          color=\"gray300\"\n          fontSize=\"medium\"\n          font=\"ubuntu\"\n          justify=\"center\"\n          textAlign=\"center\"\n        >\n          Produto\n        </Paragraph>\n\n        <Paragraph\n          color=\"gray300\"\n          fontSize=\"medium\"\n          font=\"ubuntu\"\n          justify=\"center\"\n          textAlign=\"center\"\n        >\n          Preço Unítario\n        </Paragraph>\n\n        <Paragraph\n          color=\"gray300\"\n          fontSize=\"medium\"\n          font=\"ubuntu\"\n          justify=\"center\"\n          textAlign=\"center\"\n        >\n          Quantidade\n        </Paragraph>\n\n        <div></div>\n      </S.Header>\n\n      <S.ProductsList>\n        {cart.products.map((product, index) => (\n          <>\n            <div className=\"product cell\">\n              <img\n                src={server + product.cover.url}\n                alt={product.nome}\n                className=\"product-image\"\n              />\n              <Paragraph\n                color=\"black\"\n                fontWeight=\"bold\"\n                fontSize=\"large\"\n                justify=\"center\"\n                textAlign=\"center\"\n              >\n                {product.nome}\n              </Paragraph>\n\n              <Paragraph\n                color=\"black\"\n                font=\"ubuntu\"\n                fontSize=\"xsmall\"\n                justify=\"center\"\n                textAlign=\"center\"\n              >\n                <strong>Referência:</strong> {product.slug}\n              </Paragraph>\n            </div>\n            <div className=\"price cell\">\n              <Heading\n                fontSize=\"xlarge\"\n                role=\"h4\"\n                lineBottom={false}\n                margin=\"0\"\n                justify=\"center\"\n              >\n                {handlePrice.priceNumberToReadblePrice(product.preco)}\n              </Heading>\n            </div>\n            <div className=\"quant cell\">\n              <div className=\"quant-controller\">\n                <FiMinusCircle\n                  onClick={() => {\n                    handleSub(index)\n                  }}\n                />\n\n                {product.quant}\n\n                <FiPlusCircle\n                  onClick={() => {\n                    handleAdd(index)\n                  }}\n                />\n              </div>\n            </div>\n            <div className=\"erase cell\">\n              <CgCloseO\n                onClick={() => {\n                  handleDelete(index)\n                }}\n              />\n            </div>\n          </>\n        ))}\n      </S.ProductsList>\n\n      <S.VoucherContainer>\n        <Paragraph color=\"black\" fontSize=\"large\" fontWeight=\"semiBold\">\n          CUPOM DE DESCONTO\n        </Paragraph>\n        <div className=\"input-container\">\n          <Input\n            value={cupom}\n            onChange={(e) => setCupom(e.target.value.toUpperCase())}\n          />\n          &nbsp;\n          <Button fill=\"brown\" onClick={cupomCheck}>\n            OK\n          </Button>\n        </div>\n      </S.VoucherContainer>\n      <S.SubTotal>\n        <div>\n          Subtotal:{' '}\n          <strong>\n            {PriceHandler.priceNumberToReadblePrice(cart.total - cashBack)}\n          </strong>\n        </div>\n      </S.SubTotal>\n\n      <S.BuyOrView>\n        <div></div>\n\n        <Link href=\"/carrinho\" passHref>\n          <a>\n            <Button fill=\"red100\" fontSize=\"large\">\n              FINALIZAR COMPRA\n            </Button>\n          </a>\n        </Link>\n      </S.BuyOrView>\n    </S.Wrapper>\n  )\n}\n\nexport default MiniCart\n"]},"metadata":{},"sourceType":"module"}