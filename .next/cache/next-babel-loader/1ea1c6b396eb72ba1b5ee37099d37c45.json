{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\cauezitto\\\\Documents\\\\projetos\\\\JG\\\\front-end\\\\src\\\\components\\\\MiniCart\\\\index.tsx\";\nimport Paragraph from 'components/Paragraph';\nimport * as S from './styles';\nimport { MdKeyboardArrowLeft } from 'react-icons/md';\nimport { CgCloseO } from 'react-icons/cg';\nimport Heading from 'components/Heading';\nimport { FiMinusCircle, FiPlusCircle } from 'react-icons/fi';\nimport { useState, useEffect } from 'react';\nimport Input from 'components/Input';\nimport Button from 'components/Button';\nimport Link from 'next/link';\nimport { useStateContext } from 'context';\nimport handlePrice from 'utils/handlePrice';\nimport PriceHandler from 'utils/handlePrice';\nimport api from 'services/api';\n\nconst MiniCart = ({\n  onClose\n}) => {\n  const {\n    cart,\n    setCart,\n    server\n  } = useStateContext();\n  const {\n    0: cupom,\n    1: setCupom\n  } = useState('');\n  const {\n    0: cashBackPercent,\n    1: setCashBackPercent\n  } = useState(0);\n  const {\n    0: cashBack,\n    1: setCashBack\n  } = useState(0);\n\n  const handleDelete = position => {\n    let total = 0.0;\n    const products = cart.products.filter(product => product !== cart.products[position]);\n    console.log(products);\n    products.map(product => {\n      total = total + product.preco * product.quant;\n    });\n    setCart({\n      products,\n      total\n    });\n  };\n\n  const cupomCheck = async () => {\n    await api.get(`/cupom/${cupom}`).then(response => {\n      const {\n        desconto\n      } = response.data;\n      setCashBackPercent(desconto);\n    }).catch(err => {\n      console.log(err);\n      alert('Cumpom inválido');\n    });\n  };\n\n  const cashBackCalculate = () => {\n    const total = cart.total;\n    const discount = total / 100 * cashBackPercent; // discount = total * cashBackPercent\n\n    setCashBack(discount);\n  };\n\n  useEffect(() => {\n    cashBackCalculate();\n  }, [cart, cashBackPercent]);\n\n  const handleAdd = position => {\n    const products = cart.products;\n    let total = 0;\n    products[position].quant = products[position].quant + 1;\n    products.map(product => {\n      total = total + product.preco * product.quant;\n    });\n    setCart({\n      products,\n      total\n    });\n  };\n\n  const handleSub = position => {\n    const products = cart.products;\n    let total = 0;\n\n    if (products[position].quant === 1) {\n      return;\n    }\n\n    products[position].quant = products[position].quant - 1;\n    products.map(product => {\n      total = total + product.preco * product.quant;\n    });\n    setCart({\n      products,\n      total\n    });\n  };\n\n  useEffect(() => {\n    if (cart.total === 0) {\n      onClose();\n    }\n  }, [cart]);\n  return /*#__PURE__*/_jsxDEV(S.Wrapper, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"close\",\n      children: /*#__PURE__*/_jsxDEV(MdKeyboardArrowLeft, {\n        onClick: onClose\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Paragraph, {\n      color: \"black\",\n      fontSize: \"small\",\n      font: \"ubuntu\",\n      fontWeight: \"semiBold\",\n      justify: \"center\",\n      textAlign: \"center\",\n      children: \"ITENS ADICIONADOS NO CARRINHO DE COMPRAS\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(S.Header, {\n      children: [/*#__PURE__*/_jsxDEV(Paragraph, {\n        color: \"gray300\",\n        fontSize: \"medium\",\n        font: \"ubuntu\",\n        justify: \"center\",\n        textAlign: \"center\",\n        children: \"Produto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Paragraph, {\n        color: \"gray300\",\n        fontSize: \"medium\",\n        font: \"ubuntu\",\n        justify: \"center\",\n        textAlign: \"center\",\n        children: \"Pre\\xE7o Un\\xEDtario\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Paragraph, {\n        color: \"gray300\",\n        fontSize: \"medium\",\n        font: \"ubuntu\",\n        justify: \"center\",\n        textAlign: \"center\",\n        children: \"Quantidade\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(S.ProductsList, {\n      children: cart.products.map((product, index) => /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product cell\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: server + product.cover.url,\n            alt: product.nome,\n            className: \"product-image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Paragraph, {\n            color: \"black\",\n            fontWeight: \"bold\",\n            fontSize: \"large\",\n            justify: \"center\",\n            textAlign: \"center\",\n            children: product.nome\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Paragraph, {\n            color: \"black\",\n            font: \"ubuntu\",\n            fontSize: \"xsmall\",\n            justify: \"center\",\n            textAlign: \"center\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Refer\\xEAncia:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 17\n            }, this), \" \", product.slug]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"price cell\",\n          children: /*#__PURE__*/_jsxDEV(Heading, {\n            fontSize: \"xlarge\",\n            role: \"h4\",\n            lineBottom: false,\n            margin: \"0\",\n            justify: \"center\",\n            children: handlePrice.priceNumberToReadblePrice(product.preco)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"quant cell\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"quant-controller\",\n            children: [/*#__PURE__*/_jsxDEV(FiMinusCircle, {\n              onClick: () => {\n                handleSub(index);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 17\n            }, this), product.quant, /*#__PURE__*/_jsxDEV(FiPlusCircle, {\n              onClick: () => {\n                handleAdd(index);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"erase cell\",\n          children: /*#__PURE__*/_jsxDEV(CgCloseO, {\n            onClick: () => {\n              handleDelete(index);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(S.VoucherContainer, {\n      children: [/*#__PURE__*/_jsxDEV(Paragraph, {\n        color: \"black\",\n        fontSize: \"large\",\n        fontWeight: \"semiBold\",\n        children: \"CUPOM DE DESCONTO\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"input-container\",\n        children: [/*#__PURE__*/_jsxDEV(Input, {\n          value: cupom,\n          onChange: e => setCupom(e.target.value.toUpperCase())\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 11\n        }, this), \"\\xA0\", /*#__PURE__*/_jsxDEV(Button, {\n          fill: \"brown\",\n          onClick: cupomCheck,\n          children: \"OK\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(S.SubTotal, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Subtotal:\", ' ', /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: PriceHandler.priceNumberToReadblePrice(cart.total - cashBack)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(S.BuyOrView, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        href: \"/carrinho\",\n        passHref: true,\n        children: /*#__PURE__*/_jsxDEV(\"a\", {\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            fill: \"red100\",\n            fontSize: \"large\",\n            children: \"FINALIZAR COMPRA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 113,\n    columnNumber: 5\n  }, this);\n};\n\nexport default MiniCart;","map":{"version":3,"sources":["C:/Users/cauezitto/Documents/projetos/JG/front-end/src/components/MiniCart/index.tsx"],"names":["Paragraph","S","MdKeyboardArrowLeft","CgCloseO","Heading","FiMinusCircle","FiPlusCircle","useState","useEffect","Input","Button","Link","useStateContext","handlePrice","PriceHandler","api","MiniCart","onClose","cart","setCart","server","cupom","setCupom","cashBackPercent","setCashBackPercent","cashBack","setCashBack","handleDelete","position","total","products","filter","product","console","log","map","preco","quant","cupomCheck","get","then","response","desconto","data","catch","err","alert","cashBackCalculate","discount","handleAdd","handleSub","index","cover","url","nome","slug","priceNumberToReadblePrice","e","target","value","toUpperCase"],"mappings":"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","sourcesContent":["import Paragraph from 'components/Paragraph'\nimport * as S from './styles'\nimport { MdKeyboardArrowLeft } from 'react-icons/md'\nimport { CgCloseO } from 'react-icons/cg'\nimport Heading from 'components/Heading'\nimport { FiMinusCircle, FiPlusCircle } from 'react-icons/fi'\nimport { useState, useEffect } from 'react'\nimport Input from 'components/Input'\nimport Button from 'components/Button'\nimport Link from 'next/link'\nimport { useStateContext } from 'context'\nimport handlePrice from 'utils/handlePrice'\nimport PriceHandler from 'utils/handlePrice'\nimport api from 'services/api'\n\nexport type Props = {\n  onClose: VoidFunction\n}\n\nconst MiniCart = ({ onClose }: Props) => {\n  const { cart, setCart, server } = useStateContext()\n  const [cupom, setCupom] = useState('')\n  const [cashBackPercent, setCashBackPercent] = useState(0)\n  const [cashBack, setCashBack] = useState(0)\n\n  const handleDelete = (position: number) => {\n    let total = 0.0\n\n    const products = cart.products.filter(\n      (product) => product !== cart.products[position]\n    )\n    console.log(products)\n\n    products.map((product) => {\n      total = total + product.preco * product.quant\n    })\n\n    setCart({\n      products,\n      total\n    })\n  }\n  const cupomCheck = async () => {\n    await api\n      .get(`/cupom/${cupom}`)\n      .then((response) => {\n        const { desconto } = response.data\n        setCashBackPercent(desconto)\n      })\n      .catch((err) => {\n        console.log(err)\n        alert('Cumpom inválido')\n      })\n  }\n\n  const cashBackCalculate = () => {\n    const total = cart.total\n\n    const discount = (total / 100) * cashBackPercent\n    // discount = total * cashBackPercent\n\n    setCashBack(discount)\n  }\n\n  useEffect(() => {\n    cashBackCalculate()\n  }, [cart, cashBackPercent])\n\n  const handleAdd = (position: number) => {\n    const products = cart.products\n    let total = 0\n\n    products[position].quant = products[position].quant + 1\n\n    products.map((product) => {\n      total = total + product.preco * product.quant\n    })\n\n    setCart({\n      products,\n      total\n    })\n  }\n\n  const handleSub = (position: number) => {\n    const products = cart.products\n\n    let total = 0\n\n    if (products[position].quant === 1) {\n      return\n    }\n\n    products[position].quant = products[position].quant - 1\n\n    products.map((product) => {\n      total = total + product.preco * product.quant\n    })\n\n    setCart({\n      products,\n      total\n    })\n  }\n\n  useEffect(() => {\n    if (cart.total === 0) {\n      onClose()\n    }\n  }, [cart])\n\n  return (\n    <S.Wrapper>\n      <div className=\"close\">\n        <MdKeyboardArrowLeft onClick={onClose} />\n      </div>\n      <Paragraph\n        color=\"black\"\n        fontSize=\"small\"\n        font=\"ubuntu\"\n        fontWeight=\"semiBold\"\n        justify=\"center\"\n        textAlign=\"center\"\n      >\n        ITENS ADICIONADOS NO CARRINHO DE COMPRAS\n      </Paragraph>\n\n      <S.Header>\n        <Paragraph\n          color=\"gray300\"\n          fontSize=\"medium\"\n          font=\"ubuntu\"\n          justify=\"center\"\n          textAlign=\"center\"\n        >\n          Produto\n        </Paragraph>\n\n        <Paragraph\n          color=\"gray300\"\n          fontSize=\"medium\"\n          font=\"ubuntu\"\n          justify=\"center\"\n          textAlign=\"center\"\n        >\n          Preço Unítario\n        </Paragraph>\n\n        <Paragraph\n          color=\"gray300\"\n          fontSize=\"medium\"\n          font=\"ubuntu\"\n          justify=\"center\"\n          textAlign=\"center\"\n        >\n          Quantidade\n        </Paragraph>\n\n        <div></div>\n      </S.Header>\n\n      <S.ProductsList>\n        {cart.products.map((product, index) => (\n          <>\n            <div className=\"product cell\">\n              <img\n                src={server + product.cover.url}\n                alt={product.nome}\n                className=\"product-image\"\n              />\n              <Paragraph\n                color=\"black\"\n                fontWeight=\"bold\"\n                fontSize=\"large\"\n                justify=\"center\"\n                textAlign=\"center\"\n              >\n                {product.nome}\n              </Paragraph>\n\n              <Paragraph\n                color=\"black\"\n                font=\"ubuntu\"\n                fontSize=\"xsmall\"\n                justify=\"center\"\n                textAlign=\"center\"\n              >\n                <strong>Referência:</strong> {product.slug}\n              </Paragraph>\n            </div>\n            <div className=\"price cell\">\n              <Heading\n                fontSize=\"xlarge\"\n                role=\"h4\"\n                lineBottom={false}\n                margin=\"0\"\n                justify=\"center\"\n              >\n                {handlePrice.priceNumberToReadblePrice(product.preco)}\n              </Heading>\n            </div>\n            <div className=\"quant cell\">\n              <div className=\"quant-controller\">\n                <FiMinusCircle\n                  onClick={() => {\n                    handleSub(index)\n                  }}\n                />\n\n                {product.quant}\n\n                <FiPlusCircle\n                  onClick={() => {\n                    handleAdd(index)\n                  }}\n                />\n              </div>\n            </div>\n            <div className=\"erase cell\">\n              <CgCloseO\n                onClick={() => {\n                  handleDelete(index)\n                }}\n              />\n            </div>\n          </>\n        ))}\n      </S.ProductsList>\n\n      <S.VoucherContainer>\n        <Paragraph color=\"black\" fontSize=\"large\" fontWeight=\"semiBold\">\n          CUPOM DE DESCONTO\n        </Paragraph>\n        <div className=\"input-container\">\n          <Input\n            value={cupom}\n            onChange={(e) => setCupom(e.target.value.toUpperCase())}\n          />\n          &nbsp;\n          <Button fill=\"brown\" onClick={cupomCheck}>\n            OK\n          </Button>\n        </div>\n      </S.VoucherContainer>\n      <S.SubTotal>\n        <div>\n          Subtotal:{' '}\n          <strong>\n            {PriceHandler.priceNumberToReadblePrice(cart.total - cashBack)}\n          </strong>\n        </div>\n      </S.SubTotal>\n\n      <S.BuyOrView>\n        <div></div>\n\n        <Link href=\"/carrinho\" passHref>\n          <a>\n            <Button fill=\"red100\" fontSize=\"large\">\n              FINALIZAR COMPRA\n            </Button>\n          </a>\n        </Link>\n      </S.BuyOrView>\n    </S.Wrapper>\n  )\n}\n\nexport default MiniCart\n"]},"metadata":{},"sourceType":"module"}