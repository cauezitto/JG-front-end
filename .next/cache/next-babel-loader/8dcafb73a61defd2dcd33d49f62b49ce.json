{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport Heading from 'components/Heading';\nimport Container from 'styles/pages/Cadastro';\nimport Paragraph from 'components/Paragraph';\nimport Button from 'components/Button';\nimport Image from 'next/image';\nimport { FiFacebook } from 'react-icons/fi';\nimport { ImGooglePlus } from 'react-icons/im';\nimport Link from 'next/link';\nimport StyledLink from 'components/Link';\nimport Label from 'components/Label';\nimport Input from 'components/Input';\nimport { useState, useEffect } from 'react';\nimport api from 'services/api';\nimport { useStateContext } from 'context';\nimport { useRouter } from 'next/router';\nimport cep from 'cep-promise';\nimport { useCookies } from 'react-cookie';\nimport { cepMask } from 'utils/masks';\n\nconst Cadastro = () => {\n  const {\n    0: nome,\n    1: setNome\n  } = useState('');\n  const {\n    0: email,\n    1: setEmail\n  } = useState('');\n  const {\n    0: phone,\n    1: setPhone\n  } = useState('');\n  const {\n    0: endereco,\n    1: setEndereco\n  } = useState('');\n  const {\n    0: street,\n    1: setStreet\n  } = useState('');\n  const {\n    0: neighborhood,\n    1: setNeighborhood\n  } = useState('');\n  const {\n    0: city,\n    1: setCity\n  } = useState('');\n  const {\n    0: number,\n    1: setNumber\n  } = useState('');\n  const {\n    0: state,\n    1: setState\n  } = useState('');\n  const {\n    0: password,\n    1: setPassword\n  } = useState('');\n  const {\n    token,\n    setToken,\n    setUser\n  } = useStateContext();\n  const [cookie, setCookie] = useCookies(['user']);\n  const {\n    0: error,\n    1: setError\n  } = useState(false);\n  const router = useRouter();\n\n  const send = async () => {\n    if (endereco.length < 8) {\n      alert('cep incompleto');\n      return;\n    }\n\n    if (nome === '' || email === '' || password === '' || phone === '' || endereco === '' || street === '' || neighborhood === '' || city === '' || number === '') {\n      alert('dados incompletos');\n      return;\n    } else if (endereco.length < 8) {\n      alert('cep incompleto');\n      return;\n    } else if (error) {\n      alert('cep invalido, por favor confira seus dados');\n      return;\n    }\n\n    await api.post('/user', {\n      username: nome,\n      email,\n      password,\n      fone: phone,\n      endereco: {\n        cep: endereco,\n        rua: street,\n        bairro: neighborhood,\n        cidade: city,\n        UF: state,\n        numero: number\n      }\n    }).then(response => {\n      var _user$foto;\n\n      const {\n        data\n      } = response;\n      const {\n        user\n      } = data;\n      console.log(response.data);\n      const userData = {\n        username: user.username,\n        email: user.email,\n        phone: user.phone,\n        endereco: user.endereco,\n        photo: (_user$foto = user.foto) === null || _user$foto === void 0 ? void 0 : _user$foto.url,\n        favorites: user.favoritos.produtos.map(produto => produto.id)\n      };\n      setToken(data.jwt);\n      setUser(userData);\n      setCookie('token', data.jwt, {\n        path: '/',\n        maxAge: 604800,\n        // Expires after 1hr\n        sameSite: true\n      });\n      setCookie('user', userData, {\n        path: '/',\n        maxAge: 604800,\n        // Expires after 1hr\n        sameSite: true\n      });\n      router.push('/dashboard/pedidos');\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const checkAddress = async () => {\n    setError(true);\n    await cep(endereco).then(response => {\n      const {\n        state,\n        city,\n        street,\n        neighborhood\n      } = response;\n      setState(state);\n      setCity(city);\n      setStreet(street);\n      setNeighborhood(neighborhood);\n      setError(false);\n    }).catch(() => {\n      //console.log(err)\n      alert('cep invalido');\n      setError(true);\n    });\n  };\n\n  useEffect(() => {\n    if (endereco.length === 8) {\n      checkAddress();\n    }\n  }, [endereco]);\n  return /*#__PURE__*/_jsx(Container, {\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: \"sub-container\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"go2login\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"content\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"logo-wrapper\",\n            onClick: () => {\n              router.push('/');\n            },\n            children: /*#__PURE__*/_jsx(Image, {\n              src: \"/img/logo.webp\",\n              height: 40,\n              width: 140\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"text-wrapper\",\n            children: [/*#__PURE__*/_jsx(Heading, {\n              font: \"ubuntu\",\n              fontWeight: \"bold\",\n              fontSize: \"max\",\n              justify: \"center\",\n              lineBottom: false,\n              role: \"h2\",\n              children: \"Voc\\xEA por aqui! :)\"\n            }), /*#__PURE__*/_jsxs(Paragraph, {\n              fontWeight: \"semiBold\",\n              justify: \"center\",\n              textAlign: \"center\",\n              font: \"ubuntu\",\n              fontSize: \"large\",\n              margin: \"20px 0 30px 0\",\n              children: [\"Para se manter conectado conosco, \", /*#__PURE__*/_jsx(\"br\", {}), \" por favor fa\\xE7a seu login\"]\n            }), /*#__PURE__*/_jsx(Link, {\n              href: \"/login\",\n              passHref: true,\n              children: /*#__PURE__*/_jsx(\"a\", {\n                children: /*#__PURE__*/_jsx(Button, {\n                  radius: 50,\n                  fontSize: \"large\",\n                  fontWeight: \"semiBold\",\n                  outline: true,\n                  color: \"black\",\n                  children: \"LOGIN\"\n                })\n              })\n            })]\n          }), \"\\xA0\"]\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"go2login-mobile-wrapper\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"go2login-mobile\",\n          children: [\"Voc\\xEA por aqui! :) \\xA0\", /*#__PURE__*/_jsx(StyledLink, {\n            href: \"/login\",\n            color: \"white100\",\n            fontSize: \"xlarge\",\n            fontWeight: \"semiBold\",\n            children: \"Login\"\n          })]\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"register-wrapper\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"title\",\n          children: /*#__PURE__*/_jsx(Heading, {\n            justify: \"center\",\n            color: \"white100\",\n            fontSize: \"max\",\n            margin: \"0\",\n            lineBottom: false,\n            children: \"Fa\\xE7a seu cadastro\"\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"icons\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"icon-wrapper\",\n            children: /*#__PURE__*/_jsx(FiFacebook, {})\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"icon-wrapper\",\n            children: /*#__PURE__*/_jsx(ImGooglePlus, {})\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"text\",\n          children: /*#__PURE__*/_jsx(Paragraph, {\n            justify: \"center\",\n            textAlign: \"center\",\n            font: \"ubuntu\",\n            fontSize: \"xlarge\",\n            children: \"ou use seu email para se registrar\"\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"name\",\n          children: /*#__PURE__*/_jsxs(Label, {\n            color: \"white100\",\n            fontWeight: \"bold\",\n            fontSize: \"large\",\n            children: [\"\\xA0 NOME\", /*#__PURE__*/_jsx(Input, {\n              radius: 50,\n              height: 45,\n              value: nome,\n              borderColor: \"white100\",\n              onChange: e => setNome(e.target.value)\n            })]\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"email\",\n          children: /*#__PURE__*/_jsxs(Label, {\n            color: \"white100\",\n            fontWeight: \"bold\",\n            fontSize: \"large\",\n            children: [\"\\xA0 EMAIL\", /*#__PURE__*/_jsx(Input, {\n              radius: 50,\n              height: 45,\n              value: email,\n              borderColor: \"white100\",\n              onChange: e => setEmail(e.target.value)\n            })]\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"phone\",\n          children: /*#__PURE__*/_jsxs(Label, {\n            color: \"white100\",\n            fontWeight: \"bold\",\n            fontSize: \"large\",\n            children: [\"\\xA0 CELULAR\", /*#__PURE__*/_jsx(Input, {\n              radius: 50,\n              height: 45,\n              borderColor: \"white100\",\n              value: phone,\n              onChange: e => setPhone(e.target.value)\n            })]\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"address\",\n          children: /*#__PURE__*/_jsxs(Label, {\n            color: \"white100\",\n            fontWeight: \"bold\",\n            fontSize: \"large\",\n            children: [\"\\xA0 CEP\", /*#__PURE__*/_jsx(Input, {\n              radius: 50,\n              height: 45,\n              borderColor: \"white100\",\n              value: endereco,\n              onChange: e => setEndereco(cepMask(e.target.value)),\n              maxLength: 8\n            })]\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"number\",\n          children: /*#__PURE__*/_jsxs(Label, {\n            color: \"white100\",\n            fontWeight: \"bold\",\n            fontSize: \"large\",\n            children: [\"\\xA0 N\\xB0\", /*#__PURE__*/_jsx(Input, {\n              radius: 50,\n              height: 45,\n              borderColor: \"white100\",\n              value: number,\n              onChange: e => setNumber(e.target.value),\n              maxLength: 8\n            })]\n          })\n        }), street !== '' && /*#__PURE__*/_jsx(_Fragment, {\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"street\",\n            children: /*#__PURE__*/_jsxs(Label, {\n              color: \"white100\",\n              fontWeight: \"bold\",\n              fontSize: \"large\",\n              children: [\"\\xA0 ENDERE\\xC7O\", /*#__PURE__*/_jsx(Input, {\n                radius: 50,\n                height: 45,\n                borderColor: \"white100\",\n                value: `${street},  ${neighborhood},  ${city},  ${state}`,\n                readOnly: true,\n                maxLength: 8\n              })]\n            })\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"password\",\n          children: /*#__PURE__*/_jsxs(Label, {\n            color: \"white100\",\n            fontWeight: \"bold\",\n            fontSize: \"large\",\n            children: [\"\\xA0 SENHA\", /*#__PURE__*/_jsx(Input, {\n              radius: 50,\n              height: 45,\n              borderColor: \"white100\",\n              value: password,\n              onChange: e => setPassword(e.target.value)\n            })]\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"send\",\n          children: /*#__PURE__*/_jsx(Button, {\n            radius: 50,\n            fill: \"red100\",\n            fontSize: \"xlarge\",\n            onClick: send,\n            children: \"ENVIAR\"\n          })\n        })]\n      })]\n    })\n  });\n};\n\nexport default Cadastro;","map":null,"metadata":{},"sourceType":"module"}