{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport Heading from 'components/Heading';\nimport Input from 'components/Input';\nimport Favoritos from 'styles/pages/Favoritos';\nimport { FiCopy } from 'react-icons/fi';\nimport { FaFacebookF, FaTwitter, FaWhatsapp } from 'react-icons/fa';\nimport { parseCookies } from 'helpers';\nimport jwt from 'jsonwebtoken';\nimport api from 'services/api';\nimport UnathorizedPopUp from 'components/UnathorizedPopUp';\nimport { useEffect, useState } from 'react';\nimport { useRouter } from 'next/router';\nimport PendingPermissionPopUp from 'components/PendingPermissionPopUp';\nimport { FiChevronRight } from 'react-icons/fi';\nimport FriendsList from 'components/FriendsList';\nimport ProductCard from 'components/ProductCard';\nimport GridWrapper from 'components/GridWrapper';\nimport PaddingWrapper from 'components/PaddingWrapper';\nimport DefaultTemplate from 'templates/Default';\nimport { HorizontalPaddingWrapper } from 'styles/pages/home';\nimport { useStateContext } from 'context';\nimport { getCategorias } from 'graphql/queryes/categorias';\nimport { initializeApollo } from 'utils/apollo';\nexport const getServerSideProps = async ({\n  req,\n  params = {\n    id: 1\n  }\n}) => {\n  const client = initializeApollo();\n  const response = await client.query({\n    query: getCategorias\n  });\n  const {\n    categorias\n  } = response.data;\n  const cookies = parseCookies(req);\n  let favoriteList;\n  let friends = null; // eslint-disable-next-line prefer-const\n\n  let err = false;\n\n  if (!cookies.token) {\n    return {\n      props: {\n        products: [],\n        err: {\n          login: true,\n          unauthorzed: false\n        },\n        categorias\n      }\n    };\n  }\n\n  const decoded = await jwt.decode(cookies.token);\n\n  if (!decoded) {\n    return {\n      props: {\n        products: [],\n        err: {\n          login: false,\n          unauthorized: true\n        },\n        categorias\n      }\n    };\n  }\n\n  await api.get(`/favoritos/${params.id}`, {\n    headers: {\n      Authorization: `Bearer ${cookies.token}`\n    }\n  }).then(response => {\n    favoriteList = response.data.produtos;\n    console.log(typeof params.id, decoded.id);\n\n    if (decoded.id == params.id) {\n      friends = response.data.amigos;\n    }\n  }).catch(error => {\n    err = true;\n  });\n\n  if (err) {\n    return {\n      props: {\n        products: [],\n        err: {\n          login: false,\n          unauthorized: true\n        },\n        categorias\n      }\n    };\n  }\n\n  return {\n    props: {\n      products: favoriteList ? favoriteList : [],\n      amigos: friends,\n      id: params.id,\n      err: {\n        login: false,\n        unauthorized: err ? true : false\n      },\n      categorias\n    }\n  };\n};\n\nconst Favorites = ({\n  products,\n  err,\n  amigos,\n  id,\n  categorias\n}) => {\n  const router = useRouter();\n  const {\n    0: showList,\n    1: setShowList\n  } = useState(false);\n  const {\n    server\n  } = useStateContext();\n\n  const copy = () => {\n    const input = document.querySelector('.link-input');\n    console.log(input);\n    input.select();\n    document.execCommand('copy');\n    alert('link copiado!');\n  };\n\n  const copyMobile = () => {\n    const input = document.querySelector('.link-input-mobile');\n    console.log(input);\n    input.select();\n    document.execCommand('copy');\n    alert('link copiado!');\n  };\n\n  useEffect(() => {\n    console.log(err);\n  }, []);\n  if (err.login) return /*#__PURE__*/_jsx(UnathorizedPopUp, {\n    onClose: () => {\n      router.push('/');\n    },\n    onRedirect: () => {\n      router.push('/login');\n    },\n    show: true\n  });\n\n  if (err.unauthorized) {\n    return /*#__PURE__*/_jsx(PendingPermissionPopUp, {\n      onClose: () => {\n        router.push('/');\n      },\n      show: true\n    });\n  }\n\n  return /*#__PURE__*/_jsx(DefaultTemplate, {\n    categorias: categorias,\n    children: /*#__PURE__*/_jsxs(Favoritos, {\n      children: [amigos && /*#__PURE__*/_jsx(\"div\", {\n        className: \"drop-list\",\n        onClick: () => {\n          setShowList(true);\n        },\n        children: /*#__PURE__*/_jsx(FiChevronRight, {})\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: showList ? 'list-container' : 'list-container hidden',\n        children: /*#__PURE__*/_jsx(FriendsList, {\n          amigos: amigos,\n          onClose: () => {\n            setShowList(false);\n          }\n        })\n      }), products[0] ? /*#__PURE__*/_jsxs(_Fragment, {\n        children: [/*#__PURE__*/_jsx(HorizontalPaddingWrapper, {\n          children: /*#__PURE__*/_jsx(Heading, {\n            children: \"Favoritos\"\n          })\n        }), /*#__PURE__*/_jsxs(PaddingWrapper, {\n          children: [/*#__PURE__*/_jsx(GridWrapper, {\n            children: products.map((product, index) => /*#__PURE__*/_jsx(ProductCard, {\n              id: product.id,\n              name: product.nome,\n              price: product.preco,\n              image: server + product.cover.url,\n              slug: product.slug\n            }, index))\n          }), amigos && /*#__PURE__*/_jsxs(\"div\", {\n            className: \"share-wrapper\",\n            children: [/*#__PURE__*/_jsxs(Heading, {\n              role: \"h3\",\n              lineBottom: false,\n              color: \"black\",\n              justify: \"center\",\n              children: [' ', \"Envie o link para seus amigos\"]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"space-between center\",\n              children: [/*#__PURE__*/_jsx(Input, {\n                className: \"link-input desktop\",\n                value: `https://jgemporiodamalha.com.br/favoritos/${id}`,\n                borderColor: \"brown\",\n                width: 570,\n                readOnly: true\n              }), /*#__PURE__*/_jsx(Input, {\n                className: \"mobile link-input-mobile\",\n                value: `https://jgemporiodamalha.com.br/favoritos/${id}`,\n                borderColor: \"brown\",\n                width: 300,\n                textArea: true,\n                readOnly: true\n              }), /*#__PURE__*/_jsx(FiCopy, {\n                className: \"copy desktop\",\n                onClick: copy\n              }), /*#__PURE__*/_jsx(FiCopy, {\n                className: \"copy mobile\",\n                onClick: copyMobile\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"options\",\n              children: [/*#__PURE__*/_jsx(\"a\", {\n                href: `https://facebook.com/sharer/sharer.php?u=https://jgemporio.com.br/favoritos/${id}`,\n                children: /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"option facebook\",\n                  children: [/*#__PURE__*/_jsx(FaFacebookF, {}), \" \\xA0 Facebook\"]\n                })\n              }), /*#__PURE__*/_jsx(\"a\", {\n                href: `https://twitter.com/intent/tweet?url=https://jgemporio.com.br/favoritos/${id}`,\n                children: /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"option twitter\",\n                  children: [/*#__PURE__*/_jsx(FaTwitter, {}), \" \\xA0 Twitter\"]\n                })\n              }), /*#__PURE__*/_jsx(\"a\", {\n                href: `whatsapp://send?text=https://jgemporio.com.br/favoritos/${id}`,\n                children: /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"option whatsapp\",\n                  children: [/*#__PURE__*/_jsx(FaWhatsapp, {}), \" \\xA0 Whatsapp\"]\n                })\n              })]\n            })]\n          })]\n        })]\n      }) : /*#__PURE__*/_jsx(Heading, {\n        lineBottom: false,\n        justify: \"center\",\n        margin: \"200px 0\",\n        textAlign: \"center\",\n        children: \"Parece que voc\\xEA ainda n\\xE3o tem nada em sua lista\"\n      })]\n    })\n  });\n};\n\nexport default Favorites;","map":null,"metadata":{},"sourceType":"module"}